<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>redis | wchen</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon32.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    <meta name="description" content="record wchen life">
    
    <link rel="preload" href="/assets/css/0.styles.1b049d26.css" as="style"><link rel="preload" href="/assets/js/app.8725beb4.js" as="script"><link rel="preload" href="/assets/js/3.aedd7e52.js" as="script"><link rel="preload" href="/assets/js/81.4d3ab7cf.js" as="script"><link rel="prefetch" href="/assets/js/10.0c89a17c.js"><link rel="prefetch" href="/assets/js/100.22e21bad.js"><link rel="prefetch" href="/assets/js/101.b1169e57.js"><link rel="prefetch" href="/assets/js/102.90fd103e.js"><link rel="prefetch" href="/assets/js/103.14e89f5b.js"><link rel="prefetch" href="/assets/js/104.06fc5cca.js"><link rel="prefetch" href="/assets/js/105.8f69f715.js"><link rel="prefetch" href="/assets/js/106.d8c27197.js"><link rel="prefetch" href="/assets/js/107.b7d9f2cb.js"><link rel="prefetch" href="/assets/js/108.c49c77b1.js"><link rel="prefetch" href="/assets/js/109.9a1afbcb.js"><link rel="prefetch" href="/assets/js/11.88339590.js"><link rel="prefetch" href="/assets/js/110.b30e3a13.js"><link rel="prefetch" href="/assets/js/111.5d2cf182.js"><link rel="prefetch" href="/assets/js/112.9538f788.js"><link rel="prefetch" href="/assets/js/113.14a4e516.js"><link rel="prefetch" href="/assets/js/114.ab126092.js"><link rel="prefetch" href="/assets/js/115.be4bb57a.js"><link rel="prefetch" href="/assets/js/116.8dbb3f7b.js"><link rel="prefetch" href="/assets/js/117.61931609.js"><link rel="prefetch" href="/assets/js/118.85d90fa0.js"><link rel="prefetch" href="/assets/js/119.7a0561c5.js"><link rel="prefetch" href="/assets/js/12.0e4adb62.js"><link rel="prefetch" href="/assets/js/120.b92e0bc3.js"><link rel="prefetch" href="/assets/js/121.fc43e8ef.js"><link rel="prefetch" href="/assets/js/122.d7b06645.js"><link rel="prefetch" href="/assets/js/123.43ddeb68.js"><link rel="prefetch" href="/assets/js/124.f5a25533.js"><link rel="prefetch" href="/assets/js/125.d6917ebb.js"><link rel="prefetch" href="/assets/js/126.87e25558.js"><link rel="prefetch" href="/assets/js/127.d93c3bd6.js"><link rel="prefetch" href="/assets/js/128.cd9c0723.js"><link rel="prefetch" href="/assets/js/129.4bf55679.js"><link rel="prefetch" href="/assets/js/13.cb32d651.js"><link rel="prefetch" href="/assets/js/130.80b8ac9f.js"><link rel="prefetch" href="/assets/js/131.0a13ecc2.js"><link rel="prefetch" href="/assets/js/132.cec6971c.js"><link rel="prefetch" href="/assets/js/133.4de9fe57.js"><link rel="prefetch" href="/assets/js/134.d064d2f1.js"><link rel="prefetch" href="/assets/js/135.4cbf9da8.js"><link rel="prefetch" href="/assets/js/136.2519514e.js"><link rel="prefetch" href="/assets/js/137.5c285a55.js"><link rel="prefetch" href="/assets/js/138.b5c8fa36.js"><link rel="prefetch" href="/assets/js/139.28679ddc.js"><link rel="prefetch" href="/assets/js/14.5290b05d.js"><link rel="prefetch" href="/assets/js/140.85bde7a0.js"><link rel="prefetch" href="/assets/js/141.aeb8f686.js"><link rel="prefetch" href="/assets/js/142.0e821bf5.js"><link rel="prefetch" href="/assets/js/143.bea7f5c7.js"><link rel="prefetch" href="/assets/js/144.c23cb250.js"><link rel="prefetch" href="/assets/js/145.df7c1e3e.js"><link rel="prefetch" href="/assets/js/146.5180b016.js"><link rel="prefetch" href="/assets/js/147.2a32ede1.js"><link rel="prefetch" href="/assets/js/148.62832aa8.js"><link rel="prefetch" href="/assets/js/149.cdd397e9.js"><link rel="prefetch" href="/assets/js/15.376e4dca.js"><link rel="prefetch" href="/assets/js/150.591bc885.js"><link rel="prefetch" href="/assets/js/151.4bfbd80d.js"><link rel="prefetch" href="/assets/js/152.ed8603a3.js"><link rel="prefetch" href="/assets/js/153.541b2013.js"><link rel="prefetch" href="/assets/js/154.b4f1a312.js"><link rel="prefetch" href="/assets/js/155.d20dc730.js"><link rel="prefetch" href="/assets/js/156.0db8687c.js"><link rel="prefetch" href="/assets/js/157.68037974.js"><link rel="prefetch" href="/assets/js/158.29f9cfec.js"><link rel="prefetch" href="/assets/js/159.c318c6c0.js"><link rel="prefetch" href="/assets/js/16.e6fd44a3.js"><link rel="prefetch" href="/assets/js/160.5b6bb350.js"><link rel="prefetch" href="/assets/js/161.8a804971.js"><link rel="prefetch" href="/assets/js/162.2e1df994.js"><link rel="prefetch" href="/assets/js/163.87a2b4b7.js"><link rel="prefetch" href="/assets/js/164.f8c7dc6a.js"><link rel="prefetch" href="/assets/js/165.f8d8f2ee.js"><link rel="prefetch" href="/assets/js/166.ea9c7e6b.js"><link rel="prefetch" href="/assets/js/167.8a5394d8.js"><link rel="prefetch" href="/assets/js/168.44858922.js"><link rel="prefetch" href="/assets/js/169.7a4c83f9.js"><link rel="prefetch" href="/assets/js/17.8b54be9f.js"><link rel="prefetch" href="/assets/js/170.08fdf9e1.js"><link rel="prefetch" href="/assets/js/171.c3706a48.js"><link rel="prefetch" href="/assets/js/172.4a59fe97.js"><link rel="prefetch" href="/assets/js/173.18b82370.js"><link rel="prefetch" href="/assets/js/174.9d674ed8.js"><link rel="prefetch" href="/assets/js/175.cc6ad8f7.js"><link rel="prefetch" href="/assets/js/176.4794a561.js"><link rel="prefetch" href="/assets/js/177.0dc3d05a.js"><link rel="prefetch" href="/assets/js/178.88084643.js"><link rel="prefetch" href="/assets/js/179.c44b918c.js"><link rel="prefetch" href="/assets/js/18.92f98bc1.js"><link rel="prefetch" href="/assets/js/180.7d19ae5a.js"><link rel="prefetch" href="/assets/js/181.a204908e.js"><link rel="prefetch" href="/assets/js/182.5db8323f.js"><link rel="prefetch" href="/assets/js/183.fbedeba3.js"><link rel="prefetch" href="/assets/js/184.df5c0632.js"><link rel="prefetch" href="/assets/js/185.978c670d.js"><link rel="prefetch" href="/assets/js/186.98f653b8.js"><link rel="prefetch" href="/assets/js/187.b2fe7440.js"><link rel="prefetch" href="/assets/js/188.5c4b8dea.js"><link rel="prefetch" href="/assets/js/189.1628eee4.js"><link rel="prefetch" href="/assets/js/19.25548c65.js"><link rel="prefetch" href="/assets/js/190.75dac6e5.js"><link rel="prefetch" href="/assets/js/191.e5701c49.js"><link rel="prefetch" href="/assets/js/192.bb4edece.js"><link rel="prefetch" href="/assets/js/193.1899fbaa.js"><link rel="prefetch" href="/assets/js/194.49d5dabc.js"><link rel="prefetch" href="/assets/js/195.a4cdc959.js"><link rel="prefetch" href="/assets/js/196.f068ee8d.js"><link rel="prefetch" href="/assets/js/197.692fe19f.js"><link rel="prefetch" href="/assets/js/198.d4131506.js"><link rel="prefetch" href="/assets/js/199.57d7a3e3.js"><link rel="prefetch" href="/assets/js/2.666a315c.js"><link rel="prefetch" href="/assets/js/20.773677e4.js"><link rel="prefetch" href="/assets/js/200.23cc8cf1.js"><link rel="prefetch" href="/assets/js/201.cec5b858.js"><link rel="prefetch" href="/assets/js/202.4414fac2.js"><link rel="prefetch" href="/assets/js/21.eebcf8a1.js"><link rel="prefetch" href="/assets/js/22.ab9c1367.js"><link rel="prefetch" href="/assets/js/23.b9d1dc53.js"><link rel="prefetch" href="/assets/js/24.4b69923e.js"><link rel="prefetch" href="/assets/js/25.a2fe8495.js"><link rel="prefetch" href="/assets/js/26.12dcf15f.js"><link rel="prefetch" href="/assets/js/27.50073f77.js"><link rel="prefetch" href="/assets/js/28.6c68578f.js"><link rel="prefetch" href="/assets/js/29.6a0419af.js"><link rel="prefetch" href="/assets/js/30.8ed6c08d.js"><link rel="prefetch" href="/assets/js/31.301bd566.js"><link rel="prefetch" href="/assets/js/32.851bfc08.js"><link rel="prefetch" href="/assets/js/33.5d350a8c.js"><link rel="prefetch" href="/assets/js/34.ca33f595.js"><link rel="prefetch" href="/assets/js/35.983ed47a.js"><link rel="prefetch" href="/assets/js/36.9b868e72.js"><link rel="prefetch" href="/assets/js/37.449945ce.js"><link rel="prefetch" href="/assets/js/38.ef4a02f1.js"><link rel="prefetch" href="/assets/js/39.ef74d5c7.js"><link rel="prefetch" href="/assets/js/4.017bf609.js"><link rel="prefetch" href="/assets/js/40.1efa2972.js"><link rel="prefetch" href="/assets/js/41.4c4e85b4.js"><link rel="prefetch" href="/assets/js/42.8eb9f6c6.js"><link rel="prefetch" href="/assets/js/43.3a538c76.js"><link rel="prefetch" href="/assets/js/44.ac957ce4.js"><link rel="prefetch" href="/assets/js/45.20df3feb.js"><link rel="prefetch" href="/assets/js/46.104c8407.js"><link rel="prefetch" href="/assets/js/47.ed9bd1f1.js"><link rel="prefetch" href="/assets/js/48.d6e9908f.js"><link rel="prefetch" href="/assets/js/49.acd27e73.js"><link rel="prefetch" href="/assets/js/5.ef717c93.js"><link rel="prefetch" href="/assets/js/50.f6436ebc.js"><link rel="prefetch" href="/assets/js/51.4482ba40.js"><link rel="prefetch" href="/assets/js/52.15810626.js"><link rel="prefetch" href="/assets/js/53.8cc86e5d.js"><link rel="prefetch" href="/assets/js/54.fcf6b400.js"><link rel="prefetch" href="/assets/js/55.cf5d0b5a.js"><link rel="prefetch" href="/assets/js/56.d21b4a30.js"><link rel="prefetch" href="/assets/js/57.09227c2a.js"><link rel="prefetch" href="/assets/js/58.fe436573.js"><link rel="prefetch" href="/assets/js/59.016fbcaf.js"><link rel="prefetch" href="/assets/js/6.96ee5f57.js"><link rel="prefetch" href="/assets/js/60.c06293ac.js"><link rel="prefetch" href="/assets/js/61.b4e4006c.js"><link rel="prefetch" href="/assets/js/62.f5a124d5.js"><link rel="prefetch" href="/assets/js/63.2f0bed93.js"><link rel="prefetch" href="/assets/js/64.392c4569.js"><link rel="prefetch" href="/assets/js/65.7461790c.js"><link rel="prefetch" href="/assets/js/66.467fe75c.js"><link rel="prefetch" href="/assets/js/67.7472ff41.js"><link rel="prefetch" href="/assets/js/68.cfff64e0.js"><link rel="prefetch" href="/assets/js/69.92e93051.js"><link rel="prefetch" href="/assets/js/7.e6472673.js"><link rel="prefetch" href="/assets/js/70.63ff8004.js"><link rel="prefetch" href="/assets/js/71.2cc00e12.js"><link rel="prefetch" href="/assets/js/72.860d4af9.js"><link rel="prefetch" href="/assets/js/73.9d0bd3ea.js"><link rel="prefetch" href="/assets/js/74.237893f9.js"><link rel="prefetch" href="/assets/js/75.2f7650a9.js"><link rel="prefetch" href="/assets/js/76.19d4c2c8.js"><link rel="prefetch" href="/assets/js/77.f78144da.js"><link rel="prefetch" href="/assets/js/78.e0f85041.js"><link rel="prefetch" href="/assets/js/79.f1f92723.js"><link rel="prefetch" href="/assets/js/8.a8081b4b.js"><link rel="prefetch" href="/assets/js/80.9bf52d8e.js"><link rel="prefetch" href="/assets/js/82.0370835e.js"><link rel="prefetch" href="/assets/js/83.0ed1bb1f.js"><link rel="prefetch" href="/assets/js/84.cc2f8d66.js"><link rel="prefetch" href="/assets/js/85.75d5f5b3.js"><link rel="prefetch" href="/assets/js/86.65af641f.js"><link rel="prefetch" href="/assets/js/87.15f2ea85.js"><link rel="prefetch" href="/assets/js/88.e59ddda6.js"><link rel="prefetch" href="/assets/js/89.a05edea4.js"><link rel="prefetch" href="/assets/js/9.c9619e92.js"><link rel="prefetch" href="/assets/js/90.441e1039.js"><link rel="prefetch" href="/assets/js/91.8adf4b04.js"><link rel="prefetch" href="/assets/js/92.46ae5eb4.js"><link rel="prefetch" href="/assets/js/93.c1c42ffc.js"><link rel="prefetch" href="/assets/js/94.1de7aab9.js"><link rel="prefetch" href="/assets/js/95.54f28122.js"><link rel="prefetch" href="/assets/js/96.a9b78971.js"><link rel="prefetch" href="/assets/js/97.4c1f5ec9.js"><link rel="prefetch" href="/assets/js/98.6c42b155.js"><link rel="prefetch" href="/assets/js/99.cddae8d9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1b049d26.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="app"><div class="header" data-v-42c3136f><span class="logo" data-v-42c3136f>wchen</span> <div class="search-box" data-v-42c3136f><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="main"><div class="sidebar" data-v-3ad4446e><ul class="sub-1" data-v-3ad4446e><li data-v-3ad4446e><span data-v-3ad4446e><i class="iconfont" data-v-3ad4446e></i>
                C
            </span> <!----></li><li data-v-3ad4446e><span data-v-3ad4446e><i class="iconfont" data-v-3ad4446e></i>
                Git
            </span> <!----></li><li data-v-3ad4446e><span data-v-3ad4446e><i class="iconfont" data-v-3ad4446e></i>
                algorithm
            </span> <!----></li><li data-v-3ad4446e><span data-v-3ad4446e><i class="iconfont" data-v-3ad4446e></i>
                backend
            </span> <!----></li><li data-v-3ad4446e><span data-v-3ad4446e><i class="iconfont" data-v-3ad4446e></i>
                linux
            </span> <!----></li><li data-v-3ad4446e><span data-v-3ad4446e><i class="iconfont" data-v-3ad4446e></i>
                network
            </span> <!----></li><li data-v-3ad4446e><span data-v-3ad4446e><i class="iconfont" data-v-3ad4446e></i>
                python
            </span> <!----></li><li data-v-3ad4446e><span data-v-3ad4446e><i class="iconfont" data-v-3ad4446e></i>
                storage
            </span> <!----></li><li data-v-3ad4446e><span data-v-3ad4446e><i class="iconfont" data-v-3ad4446e></i>
                tools
            </span> <!----></li><li data-v-3ad4446e><span data-v-3ad4446e><i class="iconfont" data-v-3ad4446e></i>
                web
            </span> <!----></li><li data-v-3ad4446e><span data-v-3ad4446e><i class="iconfont" data-v-3ad4446e></i>
                README.md
            </span> <!----></li></ul></div> <div class="content__default"><h2 id="redis是什么"><a href="#redis是什么" class="header-anchor">#</a> Redis是什么</h2> <p>Redis（Remote Dictionary Server )，即远程字典服务，是一个开源的使用ANSI <a href="https://baike.baidu.com/item/C%E8%AF%AD%E8%A8%80" target="_blank" rel="noopener noreferrer">C语言<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>编写、支持网络、可基于内存亦可持久化的日志型、Key-Value<a href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%BA%93/103728" target="_blank" rel="noopener noreferrer">数据库<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，并提供多种语言的API。</p> <h3 id="redis功能"><a href="#redis功能" class="header-anchor">#</a> redis功能</h3> <ol><li>内存储存、可选持久化（RDB、AOF）</li> <li>效率高、用于高速缓存</li> <li>发布-订阅系统</li> <li>地图信息分析</li> <li>计时器、计数器（浏览量）</li></ol> <h3 id="特性"><a href="#特性" class="header-anchor">#</a> 特性</h3> <ol><li>多样的数据类型</li> <li>持久化</li> <li>集群</li> <li>事务</li> <li>....</li></ol> <h2 id="基本命令使用"><a href="#基本命令使用" class="header-anchor">#</a> 基本命令使用</h2> <h3 id="安装与启动"><a href="#安装与启动" class="header-anchor">#</a> 安装与启动</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">## 安装</span>
<span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> redis-server
<span class="token comment">## 启动</span>
redis-server
<span class="token comment">## 客户端访问</span>
redis-cli
<span class="token comment">## 退出</span>
<span class="token builtin class-name">exit</span>
</code></pre></div><h3 id="数据库操作"><a href="#数据库操作" class="header-anchor">#</a> 数据库操作</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">## 切换数据库</span>
<span class="token keyword">select</span> index <span class="token comment"># select 7， 默认存在16个数据库</span>
<span class="token comment">## 清空当前数据库</span>
flushdb
flushall <span class="token comment"># 清空所有数据库</span>
</code></pre></div><h3 id="基本操作"><a href="#基本操作" class="header-anchor">#</a> 基本操作</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">## 查看数据库中所有键值</span>
keys *
<span class="token comment">## 设置key-value</span>
<span class="token builtin class-name">set</span> key name <span class="token comment"># set name chen</span>
<span class="token comment">## 获取key-value</span>
get key
<span class="token comment">## 是否存在</span>
exists key
<span class="token comment">## 移动</span>
move key db
<span class="token comment">## 删除</span>
del key
<span class="token comment">## 设置key过期时间</span>
expire key <span class="token function">time</span>
ttl key <span class="token comment"># 查看key过期时间</span>
<span class="token comment">## 获取key的类型</span>
<span class="token builtin class-name">type</span> name
</code></pre></div><h2 id="redis是单线程"><a href="#redis是单线程" class="header-anchor">#</a> Redis是单线程</h2> <blockquote><p>Redis是单线程， CPU并不是Redis的性能瓶颈，Redis瓶颈是内存和网络带宽</p> <ol><li>误区1：高性能服务器一定是多线程</li> <li>误区2： 多线程一定比单线程效率高</li></ol> <p>核心： Redis是将所有的数据放在内存中的， 单线程的操作效率是最高的，多线程CPU上下文切换，需要耗时，对于内存系统过来说没有上下文切换的效率是最高的。</p></blockquote> <h2 id="redis的基本数据类型"><a href="#redis的基本数据类型" class="header-anchor">#</a> Redis的基本数据类型</h2> <p>Redis是一种开放源代码（BSD许可）的内存中数据结构存储，用作数据库，缓存和消息代理。它支持数据结构，例如字符串，哈希，列表，集合，带范围查询的排序集合，位图，超日志，带有半径查询和流的地理空间索引。Redis具有内置的复制，Lua脚本，LRU驱逐，事务和不同级别的磁盘持久性，并通过Redis Sentinel和Redis Cluster自动分区提供高可用性。</p> <h3 id="string"><a href="#string" class="header-anchor">#</a> string</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">set</span> key name
get key name
<span class="token comment">## 追加字符串</span>
append key value
<span class="token comment">## 长度</span>
strlen key
<span class="token comment">## 自增和自减</span>
incr key 
decr key
<span class="token comment">## 设置增量</span>
incrby key increment
decrby key decrement

<span class="token comment">## 截取字符串</span>
getrange key start end

<span class="token comment">## 替换</span>
setrange key offset value
<span class="token comment">## </span>
setex <span class="token comment"># （set with expire）设置值和过期时间</span>
setnx <span class="token comment"># (set if not exist) 如果存在就不设置</span>


<span class="token comment">## 批量获取值和设置值</span>
mset k <span class="token function">v</span> k1 v1 <span class="token punctuation">..</span><span class="token punctuation">..</span>
mget k k1 k2 <span class="token punctuation">..</span>.
<span class="token comment">## msetnx|msetex是原子操作</span>

<span class="token comment">##特殊命令</span>
mset name:<span class="token punctuation">{</span>id<span class="token punctuation">}</span>:<span class="token punctuation">{</span>field<span class="token punctuation">}</span> value <span class="token comment"># mset name:10:10 100</span>
getset key value <span class="token comment"># 先获取再设置</span>
</code></pre></div><h3 id="list"><a href="#list" class="header-anchor">#</a> list</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">## 左添加值</span>
lpush key v1 v2 v3 <span class="token punctuation">..</span>. <span class="token comment"># rpush key v1 v2 v3 ... 右添加</span>
<span class="token comment">## 获取值</span>
lrange key start end
<span class="token comment">## 获取全部值</span>
lrange key <span class="token number">0</span> -1

<span class="token comment">## 弹出值</span>
lpop <span class="token operator">|</span> rpop

<span class="token comment">## 获取长度</span>
llen key

<span class="token comment">## 移出指定个数指定值</span>
lrem key count value
</code></pre></div><blockquote><p>消息队列（lpush rpop） 、栈（lpush、lpop）</p></blockquote> <h3 id="set"><a href="#set" class="header-anchor">#</a> set</h3> <blockquote><p>set 中值是不能重复的</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">## 添加值</span>
sadd key v1 v2 v3 v4 <span class="token punctuation">..</span>.
<span class="token comment">## 查看</span>
smembers key
<span class="token comment">## 是否包含</span>
sismember key value
<span class="token comment">## 获取长度</span>
scard key
<span class="token comment">## 移除</span>
srem key value
<span class="token comment">## 随机抽取</span>
srandmember key
<span class="token comment">### 数字的交并差</span>
<span class="token function">sdiff</span> k1 k2 <span class="token comment"># 差集</span>
sinter k1 k2 <span class="token comment"># 交集</span>
sunion k1 k2 <span class="token comment"># 并集</span>

</code></pre></div><h3 id="hash"><a href="#hash" class="header-anchor">#</a> hash</h3> <blockquote><p>map集合、存放map集合,本质上和string类型没有太大的区别，只是一个简单的key-value</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">## 添加值</span>
hset k kk vv <span class="token comment"># hset stu name chen</span>
<span class="token comment">## 获取值</span>
hget k kk
<span class="token comment">## 获取多个值</span>
hmset <span class="token operator">|</span> hmget
</code></pre></div><h3 id="zset"><a href="#zset" class="header-anchor">#</a> zset</h3> <blockquote><p>有序集合</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code>zadd key score value
</code></pre></div><h2 id="三种特殊类型"><a href="#三种特殊类型" class="header-anchor">#</a> 三种特殊类型</h2> <h3 id="geospatial地理位置"><a href="#geospatial地理位置" class="header-anchor">#</a> geospatial地理位置</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>geoadd key lat lon addr <span class="token comment"># 经度 纬度 地点</span>
geopos key addr
<span class="token comment">## 计算距离</span>
geodist key addr1 addr2
<span class="token comment">## 给精度为中心找到位置</span>
georadius key lat lon radius unit <span class="token comment"># georadius china 100 100 10000 km</span>
georadius key lat lon radius unit withcoord count c <span class="token comment"># 限定查询数量为c</span>

</code></pre></div><h3 id="hyperloglog"><a href="#hyperloglog" class="header-anchor">#</a> hyperloglog</h3> <blockquote><p>什么是基数？ 不重复的元素</p> <p>应用场景： 网页的UA（一个人网站访问多次，算作一个人）</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code>pfadd key a b c d e f g 
pfcount key
<span class="token comment"># 合并</span>
pfmerge k1 k2 <span class="token comment"># k2 -&gt; k1, k2合并到k1</span>

</code></pre></div><h3 id="bitmaps"><a href="#bitmaps" class="header-anchor">#</a> bitmaps</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>setbit key offset value
getbit key offset
<span class="token comment">## 统计操作</span>
bitcount key
</code></pre></div><h2 id="事务"><a href="#事务" class="header-anchor">#</a> 事务</h2> <p>Redis单条命令式保存原子性，但是事务不保证原子性，一个事务中的所有命令都被序列化，在事务执行过程中，按照顺序执行。</p> <h3 id="redis事务"><a href="#redis事务" class="header-anchor">#</a> redis事务</h3> <ul><li>开启事务（multi）</li> <li>命令入队（...）</li> <li>执行事务（exec）</li> <li>取消事务（discard）</li></ul> <h3 id="异常"><a href="#异常" class="header-anchor">#</a> 异常</h3> <ol><li>编译时一场：命令错误</li> <li>运行时异常</li></ol> <h3 id="锁机制"><a href="#锁机制" class="header-anchor">#</a> 锁机制</h3> <ol><li>悲观者：认为任何时候都会有问题，无论做什么都会加锁</li> <li>乐观锁： 认为什么时候都不会出问题，所以不会上锁，更新数据会判断一下， 在此期间是否有人修改过这个数据</li></ol> <h3 id="监视"><a href="#监视" class="header-anchor">#</a> 监视</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">watch</span> key
<span class="token comment">## 更新使用乐观锁检查</span>
unwatch <span class="token comment"># 解锁</span>
</code></pre></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8725beb4.js" defer></script><script src="/assets/js/3.aedd7e52.js" defer></script><script src="/assets/js/81.4d3ab7cf.js" defer></script>
  </body>
</html>
